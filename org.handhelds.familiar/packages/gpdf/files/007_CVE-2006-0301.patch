diff -u -p -Nr --exclude CVS splash/Splash.cc splash/Splash.cc
--- splash/Splash.cc	2004-05-17 20:10:49.000000000 +0200
+++ splash/Splash.cc	2006-02-04 17:54:51.000000000 +0100
@@ -734,6 +734,10 @@ void Splash::drawPixel(int x, int y, Spl
   SplashMono1P *mono1;
   SplashBGR8P *bgr8;
 
+  if ( (unsigned) x >= (unsigned) bitmap->getWidth() ||
+       (unsigned) y >= (unsigned) bitmap->getHeight())
+    return;
+
   if (noClip || state->clip->test(x, y)) {
     color = pattern->getColor(x, y);
     switch (bitmap->mode) {
@@ -771,6 +775,11 @@ void Splash::drawSpan(int x0, int x1, in
   SplashMono1 mask1;
   int i, j, n;
 
+  if ((unsigned) x0 >= (unsigned) bitmap->getWidth() ||
+      (unsigned) x1 >= (unsigned) bitmap->getWidth() ||
+      (unsigned) y >= (unsigned) bitmap->getHeight())
+    return;
+
   n = x1 - x0 + 1;
 
   switch (bitmap->mode) {
@@ -858,6 +867,11 @@ void Splash::xorSpan(int x0, int x1, int
 
   n = x1 - x0 + 1;
 
+  if ((unsigned) x0 >= (unsigned) bitmap->getWidth() ||
+      (unsigned) x1 >= (unsigned) bitmap->getWidth() ||
+      (unsigned) y >= (unsigned) bitmap->getHeight())
+    return;
+
   switch (bitmap->mode) {
   case splashModeMono1:
     mono1 = &bitmap->data.mono8[y * bitmap->rowSize + (x0 >> 3)];
